<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <title>Jason Schwartzman</title>
    <link rel="icon" href="/images/JS.png"/>
</head>

<body>
    <header>
        <div style="position:fixed;z-index:9">
        <nav>
            <div class="button-container">
                <a href="/" class="button">Home</a>
                <div class="dropdown">
                    <a href="/projects" class="curbutton">Projects</a>
                    <div class="dropdown-content">
                        <a href="/projects/compiler">Compiler</a>
                        <a href="/projects/chess">Chess</a>
                        <a href="/projects/malware-analysis">Malware Analysis</a>
                        <a href="/projects/geo-spoofing-detection">Geo-Spoofing Detection</a>
                        <a href="/projects/personal-website">Personal Website</a>
                        <a href="/projects/code-injection">Code Injection</a>
                    </div>
                </div>
                <a href="/jlang" class="button">JLang</a>
                <a href="/skills" class="button">Skills</a>
                <a href="/contact" class="button">Contact</a>
            </div>
        </nav></div><div>
        <nav>
            <div style="margin-top:53px;" class="button-container">
                <a href="/projects/compiler" class="curbutton">Compiler</a>
                <a href="/projects/chess" class="button">Chess</a>
                <a href="/projects/malware-analysis" class="button">Malware Analysis</a>
                <a href="/projects/geo-spoofing-detection" class="button">Geo-Spoofing Detection</a>
                <a href="/projects/personal-website" class="button">Personal Website</a>
                <a href="/projects/code-injection" class="button">Code Injection</a>
            </div>
        </nav></div>
    </header>
    <style>.red {
        color: red;
    }
    
    .blue {
        color: blue;
    }
    .code-container {
        width:fit-content;
        background-color: black;
        padding: 20px;
        border: 2px solid #00ff00; /* Green border */
        border-radius: 5px;
        box-shadow: 0px 0px 10px rgba(0, 255, 0, 0.5); /* Green shadow */
    }
    </style>
    <div style="margin-top: 110px;"class="terminal">
        <h1>Compiler</h1>
        <a href="https://github.com/JasonHarrisonSchwartzman/Compiler" class="github-button" target="_blank">
            <i class="fab fa-github icon"></i>GitHub Source Code</a>
        <p>Start Date: December 2022</p>
        <p>Status: Completed as of September 2023, continuing to add updates</p>
        <p>I designed my own Programming Language, JLang, which is compiled using the JLang Compiler.</p>
        <p>I have always been interested in how compilers 
            generate computer readable instructions from human readable code 
            and I wanted to learn and experience it myself so I decided to build 
            a compiler for my own Programming Language.</p>
        <h1>JLang Overview</h1>
        <p>JLang is very similar to C in terms of syntax and semantics. You can also view more <a href="https://github.com/JasonHarrisonSchwartzman/Compiler#jlang-documentation" target="_blank">documentation</a> on the project's github.</p>
        <h2>Variables & Expressions</h2>
        <div class="code-container"><pre><code><span style="color:blue">int</span> <span style="color:white">x = </span>10<span style="color:white">; </span><span style="color:gray"><em>//declaration of x, x is 10</em></span>
<span style="color:white">x =</span> 5<span style="color:white">;</span><span style="color:gray"><em> //assignment of x, x is 5</em></span>
<span style="color:red">printd</span><span style="color:white">(x);</span><span style="color:gray"><em> //prints 5</em></span>
<span style="color:blue">int</span><span style="color:white"> x = </span>20<span style="color:white">;</span><span style="color:gray"><em> //ERROR: redeclaration of x within same scope</em></span>

<span style="color:blue">int </span><span style="color:white">z = </span>2 <span style="color:white">* </span>3 <span style="color:white">+ </span>5 <span style="color:white">-</span> 2 <span style="color:white">/</span> 8<span style="color:white">;</span><span style="color:gray"><em> //read BACKWARDS in order (no PEMDAS), evaluates to 4</em></span>
<span style="color:blue">int </span><span style="color:white">y = </span>3 <span style="color: white">&& z < </span>10<span style="color:white">;</span><span style="color:gray"><em> // 10 is less than z (z is 4) FALSE (0), 3 (TRUE) AND 0 (FALSE) is FALSE (0), y is 0</em></span></code></pre></div>       
<p></p> 
<h2>Functions & Control Flow</h2>   
<div class="code-container"><pre><code><span style="color:blue">int </span><span style="color:red">foo</span><span style="color:white">(</span><span style="color:blue">int </span><span style="color:white">a, </span><span style="color:blue">int </span><span style="color:white">b) {</span><span style="color:gray"><em> //function foo, has params a and b both of type int, returns an int</em></span>
    <span style="color:orange">if </span><span style="color:white">(</span>5 <span style="color:white">== a) {</span><span style="color:gray"><em> //if a is 5, run these lines</em></span>
        <span style="color:blue">int </span><span style="color:white">a = </span>2<span style="color:white">;</span><span style="color:gray"><em> //new scope, a is 2</em></span>
        <span style="color:orange">return </span><span style="color:white">a - </span>10<span style="color:white">;</span><span style="color:gray"><em> //returns the value of 10 - 2 which is 8</em></span>
    <span style="color:white">}</span>
    <span style="color:orange">elseif </span><span style="color:white">(</span>5 <span style="color:white">< a) {</span><span style="color:gray"><em> //if above condition is false, if a is less than 5, run these lines</em></span>
        <span style="color:orange">return </span><span style="color:white">a;</span><span style="color:gray"><em> //returns whatever a is</em></span>
    <span style="color:white">}</span>
    <span style="color:orange">else </span><span style="color:white">{</span><span style="color:gray"><em> //if both conditions fail, run these lines</em></span>
        <span style="color:white">a = a * b;</span><span style="color:gray"><em> //sets parameter a to b * a</em></span>
    <span style="color:white">}</span>
    <span style="color:orange">for </span><span style="color:white">(</span><span style="color:blue">int </span><span style="color:white">i = </span>0<span style="color:white">; b < i; i = i + </span>1<span style="color:white">) {</span><span style="color:gray"><em> //initialize i to 0, run this code while condition i is less than b holds, increment i by 1 after each iteration</em></span>
        <span style="color:red">printd</span><span style="color:white">(i);</span><span style="color:gray"><em> //prints current value of i</em></span>
    <span style="color:white">}</span>
    <span style="color:gray"><em>//this is an example of an equivalent while loop
    //int i = 0;
    //while (i < b) {
    //   printd(i);
    //   i = i + 1; 
    //}
    </em><span style="color:orange">return </span><span style="color:white">i;</span><span style="color:gray"><em> //ERROR variable i in for loop is no longer in scope, however the equaivalent while loop would make it in scope</em></span>
    <span style="color:orange">return </span><span style="color:white">b;</span><span style="color:gray"><em> //returns b, last line of function MUST be a return statement</em></span>
<span style="color:white">}</span></code></pre></div>  
<p></p>
<h2>Arrays</h2>  
<div class="code-container"><pre><code><span style="color:blue">int </span><span style="color:white">array[</span>5<span style="color:white">] = </span>2<span style="color:white">;</span> <span style="color:gray"><em>//initializes an array of length 5, every element set to 2, array = [2, 2, 2, 2, 2]</em></span>
<span style="color:white">array[</span>0<span style="color:white">] = </span>10<span style="color:white">;</span> <span style="color:gray"><em>//changes element 0 to value 10, array = [10, 2, 2, 2, 2]</em></span>
<span style="color:blue">int </span><span style="color:white">x = array[</span>0<span style="color:white">];</span> <span style="color:gray"><em>//initializes a variable x to the value at array[0] which is 10</em></span>
</code></pre></div>
<p></p>
<h1>Development Process</h3>
        <p>This process was broken down into 5 major parts: Scanner, Parser, Semantics, Intermediate Representation, Code Generation. I used this <a href="https://www3.nd.edu/~dthain/compilerbook/" target="_blank">textbook</a> as a guide throughout.</p>

        <div class="code-container"><pre><code><span style="color:blue">int</span> <span style="color:red">square</span>(<span style="color:blue">int</span> <span style="color:white">num</span>) {
    <span style="color:orange">return</span> <span style="color:white">num</span> * <span style="color:white">num</span>;
}</code></pre></div>
<p></p>
        <h2>Scanner</h2>
        <p>This is the first stage of compiling where the source code is read as a stream of characters and 
            grouped into meaningful tokens. Some examples include <span style="color:blue">int</span> (for integers) <span style="color:orange">if</span> (for conditionals) and <span style="color:white">identifiers</span> (for variable and function names) as well as symbols used for syntax. </p>
            <div class="code-container"><pre><code><span style="color:cyan">INPUT:</span>

<span style="color:gray">i n t   s q u a r e     (       i n t     n u m      )        {</span>
<span style="color:white">[ 1 ]      [ 2 ]      [ 3 ]     [ 4 ]     [ 5 ]    [ 6 ]    [ 7 ]</span>
<span style="color:gray">r e t u r n     n u m       *        n u m         ;</span>
   <span style="color:white">[ 8 ]        [ 9 ]     [ 10 ]     [ 11 ]      [ 12 ]</span>
  <span style="color:gray">}</span>
<span style="color:white">[ 13 ]</span>

<span style="color:orange">------------------------------------------------------------------------------------------------------------------------------------------------</span>

<span style="color:red">OUTPUT:</span>

 <span style="color:white">[ 1 ]           [ 2 ]                    [ 3 ]              [ 4 ]           [ 5 ]                 [ 6 ]                      [ 7 ]</span>
<span style="color:gray">TOKEN_INT -> TOKEN_IDENTIFIER -> TOKEN_LEFT_PARENTHESES -> TOKEN_INT -> TOKEN_IDENTIFIER -> TOKEN_RIGHT_PARENTHESE -> TOKEN_LEFT_CURLY_BRACE -></span>
   <span style="color:white">[ 8 ]             [ 9 ]            [ 10 ]           [ 11 ]              [ 12 ]</span>
<span style="color:gray">TOKEN_RETURN -> TOKEN_IDENTIFIER -> TOKEN_MULT -> TOKEN_IDENTIFIER -> TOKEN_SEMICOLON -></span>
      <span style="color:white">[ 13 ]</span>
<span style="color:gray">TOKEN_RIGHT_CURLY_BRACE</span></code></pre></div>
<p></p>        
<h2>Parser</h2>
        <p>This next stage uses the tokens generated from the scanner. It groups the tokens into rules for the language. If tokens are like words, rules are like sentences. 
            If we have the following tokens: int x = 5 ; This forms a variable declaration rule. All rules that are parsed are added a syntax tree which holds the full program.
        </p>
        <div class="code-container"><pre><code><span style="color:cyan">INPUT:</span>

 <span style="color:white">[ 1 ]           [ 2 ]                    [ 3 ]              [ 4 ]           [ 5 ]                 [ 6 ]                      [ 7 ]</span>
<span style="color:gray">TOKEN_INT -> TOKEN_IDENTIFIER -> TOKEN_LEFT_PARENTHESES -> TOKEN_INT -> TOKEN_IDENTIFIER -> TOKEN_RIGHT_PARENTHESE -> TOKEN_LEFT_CURLY_BRACE -></span>
   <span style="color:white">[ 8 ]             [ 9 ]            [ 10 ]           [ 11 ]              [ 12 ]               [ 13 ]</span>
<span style="color:gray">TOKEN_RETURN -> TOKEN_IDENTIFIER -> TOKEN_MULT -> TOKEN_IDENTIFIER -> TOKEN_SEMICOLON -> TOKEN_RIGHT_CURLY_BRACE</span>

<span style="color:orange">------------------------------------------------------------------------------------------------------------------------------------------------</span>

<span style="color:red">OUTPUT:</span>

<span style="color:rgb(214, 22, 214)">TYPE -> int
PARAMETERS -> TYPE identifer
EXPRESSION -> identifier * identifier
STATEMENTS -> return EXPRESSION ;
FUNCTION -> TYPE identifier ( PARAMETERS ) { STATEMENTS }</span>
<span style="color:blue">
                           ________________
                          |                | 
                          |    FUNCTION    |
                          |________________|
                         /      /    |    \        
                        /      /     |     \
                       /      /      |      \
                      /      /       |       \
                   TYPE   square  PARAMETERS  STATEMENTS
                    |              |       |            \ 
                    |              |       |             \
                    |              |       |              \
                   int           TYPE     num         return EXPRESSION
                                   |                            |
                                   |                            |
                                   |                            |
                                  int                       num * num</span></code></pre></div>
        <p></p>
        <h2>Semantics</h2>
        <p>This stage includes 3 major parts: symbol creation, name resolution, and type checking.</p>

        <p>Symbol creation is when an identifier is added to a symbol table which contains all declared variables and functions.</p>

        <p>Name resolution happens after when identifiers are not used in the context of declaration such as assignment (when the variable is already declared) and in expressions.</p>

        <p>Type checking occurs after all symbols and names are resolved and is responsible for determining if all symbols and constants are used without breaking any type rules.</p>
        <div class="code-container"><pre><code><span style="color:cyan">INPUT:</span>
<span style="color:blue">
                ________________
               |                | 
               |    FUNCTION    |
               |________________|
              /      /    |    \        
             /      /     |     \
            /      /      |      \
           /      /       |       \
        TYPE   square  PARAMETERS  STATEMENTS
         |              |       |            \ 
         |              |       |             \
         |              |       |              \
        int           TYPE     num         return EXPRESSION
                        |                            |
                        |                            |
                        |                            |
                       int                       num * num</span>

<span style="color:orange">------------------------------------------------------------</span>

<span style="color:red">OUTPUT:</span>

<span style="color:rgb(12, 243, 219)">Symbol table:
square -- function type: int
num -- variable (param) type: int</span>

<span style="color:rgb(9, 199, 180)">Name resolution:
num (from Expression) -- num (variable)
num (from Expression) -- num (variable)</span>

<span style="color:rgb(15, 229, 229)">Type checking:
return statement:
square (type: int)  ==  [num (type: int)] * [num (type: int)]</span></code></pre></div>
<p></p>        
<h2>Intermediate Representation</h2>
        <p>Once the language is known to be correct in terms of syntax and semantics translating the program into a language between the source code and assembly can begin. At this stage the syntax tree is translated into a "linear" language that consists of instructions similar to assembly. This intermediate language can still hold the types of variables and the symbols they refer to.</p>
        <div class="code-container"><pre><code><span style="color:cyan">INPUT:</span>
<span style="color:blue">                ________________
               |                | 
               |    FUNCTION    |
               |________________|
              /      /    |    \        
             /      /     |     \
            /      /      |      \
           /      /       |       \
        TYPE   square  PARAMETERS  STATEMENTS
         |              |       |            \ 
         |              |       |             \
         |              |       |              \
        int           TYPE     num         return EXPRESSION
                        |                            |
                        |                            |
                        |                            |
                       int                       num * num</span>


<span style="color:rgb(12, 243, 219)">Symbol table:
square -- function type: int
num -- variable (param) type: int</span>

<span style="color:rgb(9, 199, 180)">Name resolution:
num (from Expression) -- num (variable)
num (from Expression) -- num (variable)</span>

<span style="color:rgb(15, 229, 229)">Type checking:
return statement:
square (type: int)  ==  [num (type: int)] * [num (type: int)]</span>

<span style="color:orange">-------------------------------------------------------------</span>

<span style="color:red">OUTPUT:</span>

<span style="color:violet">Operation    Argument 1       Argument 2        Result</span>
<span style="color:gray">FUNC_DECL      square
PARAM            num
MULT             num             num            temp0
RETURN          temp0</span></code></pre></div>
<p></p>        
<h2>Code Generation</h2>
        <p>In the final stage, the intermediate language is converted into assembly. Symbols are converted into addresses that a computer can recognize. The stack is being properly manipulated when functions are being called and local variables are saved.</p>
        <div class="code-container"><pre><code><span style="color:cyan">INPUT:</span>

<span style="color:violet">Operation    Argument 1       Argument 2        Result</span>
<span style="color:gray">FUNC_DECL      square
PARAM            num
MULT             num             num            temp0
RETURN          temp0</span>

<span style="color:orange">-------------------------------------------------------------</span>

<span style="color:red">OUTPUT:</span>

<span style="color:cyan">square:</span>
    <span style="color:cyan">PUSHQ</span> <span style="color:white">%rbp</span>
    <span style="color:cyan">MOVQ</span> <span style="color:white">%rsp, %rbp</span>
    <span style="color:cyan">MOVQ</span> <span style="color:white">%rdi, -8(%rbp)</span>
    <span style="color:cyan">MOVQ</span> <span style="color:white">-8(%rbp), %rbx</span>
    <span style="color:cyan">MOVQ</span> <span style="color:white">-8(%rbp), %rax</span>
    <span style="color:cyan">IMUL</span> <span style="color:white">%rbx, %rax</span>
    <span style="color:cyan">POPQ</span> <span style="color:white">%rbp</span>
    <span style="color:cyan">RET</span></code></pre></div>
<p></p>
    <h2>Conclusion</h2>
<p>You have now seen the development process for my compiler and compilers in general. 
    If you would like to try out the language for yourself, please check out <a href="/jlang">JLang</a></p>
    <div class="code-container"><pre><code><span style="color:cyan">INPUT:</span>

<span style="color:blue">int</span> <span style="color:red">square</span>(<span style="color:blue">int</span> <span style="color:white">num</span>) {
    <span style="color:orange">return</span> <span style="color:white">num</span> * <span style="color:white">num</span>;
}

<span style="color:orange">-----------------------------------------------------</span>

<span style="color:red">OUTPUT:</span>

<span style="color:cyan">square:</span>
    <span style="color:cyan">PUSHQ</span> <span style="color:white">%rbp</span>
    <span style="color:cyan">MOVQ</span> <span style="color:white">%rsp, %rbp</span>
    <span style="color:cyan">SUBQ</span> <span style="color:white">$8, %rsp</span>
    <span style="color:cyan">MOVQ</span> <span style="color:white">%rdi, -8(%rbp)</span>
    <span style="color:cyan">MOVQ</span> <span style="color:white">-8(%rbp), %rbx</span>
    <span style="color:cyan">MOVQ</span> <span style="color:white">-8(%rbp), %rax</span>
    <span style="color:cyan">IMUL</span> <span style="color:white">%rbx, %rax</span>
    <span style="color:cyan">POPQ</span> <span style="color:white">%rbp</span>
    <span style="color:cyan">RET</span></code></pre></div></code></pre></div>
    </div>
</body>
</html>
